# Настройка уведомлений

## Email (SMTP) настройки

Добавьте в `.env` файл:

```bash
SMTP_HOST=smtp.yandex.ru  # или ваш SMTP сервер
SMTP_PORT=587
SMTP_USER=your-email@yandex.ru
SMTP_PASSWORD=your-password
SMTP_FROM_EMAIL=noreply@xk-media.ru
SMTP_USE_TLS=true
```

## Telegram настройки

### 1. Создайте бота

1. Напишите [@BotFather](https://t.me/BotFather) в Telegram
2. Отправьте команду `/newbot`
3. Следуйте инструкциям и создайте бота
4. Скопируйте полученный токен (например: `123456789:ABCdefGHIjklMNOpqrsTUVwxyz`)

### 2. Получите Chat ID

**Вариант 1: Личный чат**
1. Напишите [@userinfobot](https://t.me/userinfobot) в Telegram
2. Он вернет ваш Chat ID (например: `123456789`)

**Вариант 2: Группа/канал**
1. Создайте группу или канал
2. Добавьте вашего бота как администратора
3. Отправьте сообщение в группу/канал
4. Откройте: `https://api.telegram.org/bot<YOUR_BOT_TOKEN>/getUpdates`
5. Найдите `chat.id` в ответе

### 3. Добавьте в `.env`

```bash
TELEGRAM_BOT_TOKEN=123456789:ABCdefGHIjklMNOpqrsTUVwxyz
TELEGRAM_CHAT_ID=123456789
```

## Типы уведомлений

### 1. Регистрация нового пользователя
- Email админу
- Telegram админу
- Информация: роль, имя, email

### 2. Заявка с лендинга (рекламодатель)
- Email админу
- Telegram админу
- Информация: имя, email, телефон, компания, описание

### 3. Заявка с лендинга (площадка)
- Email админу
- Telegram админу
- Информация: имя, email, телефон, заведение, описание

### 4. Успешная оплата
- Email пользователю (с информацией о пополнении баланса)
- Email админу
- Telegram админу
- Информация: сумма, назначение, ID платежа

### 5. Создание подписки
- Email пользователю (с информацией о периоде и ТВ-экране)
- Telegram админу
- Информация: ТВ-экран, период, сумма, ID подписки

## Проверка работы

После настройки проверьте:

1. **Регистрация пользователя** - должно прийти уведомление
2. **Пополнение баланса** - должно прийти уведомление об оплате
3. **Создание подписки** - должно прийти уведомление о подписке

## Логи

Если уведомления не приходят, проверьте логи:

```bash
sudo journalctl -u xk-media -n 100 --no-pager | grep -i "notification\|email\|telegram"
```
