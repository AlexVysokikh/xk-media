{% extends "base.html" %}

{% block title %}–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ ‚Äî –ê–¥–º–∏–Ω{% endblock %}

{% block logo %}
<a href="/admin" class="logo">
    <span class="logo-icon">üì∫</span>
    XK Media
</a>
{% endblock %}

{% block nav %}
<a href="/admin">–î–∞—à–±–æ—Ä–¥</a>
<a href="/admin/users" class="active">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</a>
<a href="/admin/tvs">–≠–∫—Ä–∞–Ω—ã</a>
<a href="/admin/payments">–ü–ª–∞—Ç–µ–∂–∏</a>
<a href="/admin/payouts">–í—ã–ø–ª–∞—Ç—ã</a>
<a href="/admin/settings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
<a href="/logout" class="btn btn-secondary btn-sm">–í—ã–π—Ç–∏</a>
{% endblock %}

{% block content %}
<div class="page-header" style="display: flex; justify-content: space-between; align-items: center;">
    <div>
        <h1 class="page-title">üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h1>
        <p class="page-subtitle">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª—è–º–∏ –∏ –ø–ª–æ—â–∞–¥–∫–∞–º–∏</p>
    </div>
    <a href="/admin/advertisers/add" class="btn btn-primary">+ –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª—è</a>
</div>

<!-- –§–∏–ª—å—Ç—Ä—ã -->
<div class="card" style="margin-bottom: 1.5rem;">
    <div style="display: flex; gap: 1rem; flex-wrap: wrap; align-items: center;">
        <a href="/admin/users" class="btn {% if not role_filter %}btn-primary{% else %}btn-secondary{% endif %} btn-sm">–í—Å–µ</a>
        <a href="/admin/users?role=advertiser" class="btn {% if role_filter == 'advertiser' %}btn-primary{% else %}btn-secondary{% endif %} btn-sm">–†–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª–∏</a>
        <a href="/admin/users?role=venue" class="btn {% if role_filter == 'venue' %}btn-primary{% else %}btn-secondary{% endif %} btn-sm">–ü–ª–æ—â–∞–¥–∫–∏</a>
        <div style="flex: 1;"></div>
        <span style="color: var(--text-muted);">–í—Å–µ–≥–æ: {{ users|length }}</span>
    </div>
</div>

<!-- –¢–∞–±–ª–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
<div class="card">
    <table class="table">
        <thead>
            <tr>
                <th>ID</th>
                <th>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
                <th>–ö–æ–º–ø–∞–Ω–∏—è</th>
                <th>–†–æ–ª—å</th>
                <th>–ë–∞–ª–∞–Ω—Å</th>
                <th>–°—Ç–∞—Ç—É—Å</th>
                <th>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for u in users %}
            <tr>
                <td>#{{ u.id }}</td>
                <td>
                    <div style="font-weight: 600;">{{ u.first_name or '' }} {{ u.last_name or '' }}</div>
                    <div style="font-size: 0.875rem; color: var(--text-muted);">{{ u.email }}</div>
                    {% if u.phone %}
                    <div style="font-size: 0.75rem; color: var(--text-muted);">{{ u.phone }}</div>
                    {% endif %}
                </td>
                <td>
                    {% if u.company_name %}
                    <div>{{ u.company_name }}</div>
                    <div style="font-size: 0.75rem; color: var(--text-muted);">–ò–ù–ù: {{ u.inn or '‚Äî' }}</div>
                    {% else %}
                    <span style="color: var(--text-muted);">‚Äî</span>
                    {% endif %}
                </td>
                <td>
                    {% if u.role == 'admin' %}
                    <span class="badge badge-danger">–ê–¥–º–∏–Ω</span>
                    {% elif u.role == 'advertiser' %}
                    <span class="badge badge-info">–†–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª—å</span>
                    {% else %}
                    <span class="badge badge-warning">–ü–ª–æ—â–∞–¥–∫–∞</span>
                    {% endif %}
                </td>
                <td>
                    {% if u.role == 'advertiser' %}
                    <span style="font-weight: 600;">{{ "%.0f"|format(u.balance or 0) }} ‚ÇΩ</span>
                    {% else %}
                    ‚Äî
                    {% endif %}
                </td>
                <td>
                    {% if u.is_active %}
                    <span class="badge badge-success">–ê–∫—Ç–∏–≤–µ–Ω</span>
                    {% else %}
                    <span class="badge badge-danger">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω</span>
                    {% endif %}
                    {% if u.is_verified %}
                    <span class="badge badge-info" style="margin-left: 0.25rem;">‚úì</span>
                    {% endif %}
                </td>
                <td style="font-size: 0.875rem; color: var(--text-muted);">
                    {{ u.created_at.strftime('%d.%m.%Y') }}
                </td>
                <td>
                    <a href="/admin/user/{{ u.id }}" class="btn btn-secondary btn-sm">–û—Ç–∫—Ä—ã—Ç—å</a>
                </td>
            </tr>
            {% endfor %}
            {% if not users %}
            <tr>
                <td colspan="8" style="text-align: center; padding: 3rem; color: var(--text-muted);">
                    –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
                </td>
            </tr>
            {% endif %}
        </tbody>
    </table>
</div>
{% endblock %}
