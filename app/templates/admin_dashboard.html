{% extends "base.html" %}

{% block title %}–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å ‚Äî XK Media{% endblock %}

{% block logo %}
<a href="/admin" class="logo">
    <span class="logo-icon">üì∫</span>
    XK Media
</a>
{% endblock %}

{% block nav %}
<a href="/admin" class="active">–î–∞—à–±–æ—Ä–¥</a>
<a href="/admin/users">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</a>
<a href="/admin/tvs">–≠–∫—Ä–∞–Ω—ã</a>
<a href="/admin/payments">–ü–ª–∞—Ç–µ–∂–∏</a>
<a href="/admin/payouts">–í—ã–ø–ª–∞—Ç—ã</a>
<a href="/admin/settings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
<a href="/logout" class="btn btn-secondary btn-sm">–í—ã–π—Ç–∏</a>
{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">üéõÔ∏è –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h1>
    <p class="page-subtitle">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ user.first_name or user.email }}!</p>
</div>

<!-- Stats Grid -->
<div class="grid grid-3" style="margin-bottom: 2rem;">
    <div class="card stat-card">
        <div class="stat-value">{{ stats.total_users }}</div>
        <div class="stat-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
        <div style="margin-top: 0.5rem; font-size: 0.75rem; color: var(--text-muted);">
            {{ stats.advertisers }} —Ä–µ–∫–ª. / {{ stats.venues }} –ø–ª–æ—â.
        </div>
    </div>
    <div class="card stat-card">
        <div class="stat-value">{{ stats.total_tvs }}</div>
        <div class="stat-label">–¢–í-—ç–∫—Ä–∞–Ω–æ–≤</div>
    </div>
    <div class="card stat-card">
        <div class="stat-value">{{ stats.total_revenue }} ‚ÇΩ</div>
        <div class="stat-label">–û–±—â–∏–π –¥–æ—Ö–æ–¥</div>
    </div>
</div>

<!-- Quick Actions -->
<div class="grid grid-2" style="margin-bottom: 2rem;">
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">‚ö° –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>
        </div>
        <div style="display: flex; flex-direction: column; gap: 0.75rem;">
            <a href="/admin/users?role=advertiser" class="btn btn-secondary">üë§ –†–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª–∏</a>
            <a href="/admin/users?role=venue" class="btn btn-secondary">üè¢ –ü–ª–æ—â–∞–¥–∫–∏</a>
            <a href="/admin/tvs" class="btn btn-secondary">üì∫ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¢–í</a>
            <a href="/admin/payments" class="btn btn-secondary">üí≥ –ü–ª–∞—Ç–µ–∂–∏</a>
            <a href="/admin/payouts" class="btn btn-secondary">üí∏ –í—ã–ø–ª–∞—Ç—ã</a>
            <a href="/admin/settings" class="btn btn-secondary">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (–û—Ñ–µ—Ä—Ç–∞)</a>
        </div>
    </div>
    
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">üìä –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∏</h3>
        </div>
        {% if payments %}
        <div style="display: flex; flex-direction: column; gap: 0.75rem;">
            {% for p in payments %}
            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem 0; border-bottom: 1px solid var(--border);">
                <div>
                    <div style="font-weight: 500;">{{ "%.0f"|format(p.amount) }} ‚ÇΩ</div>
                    <div style="font-size: 0.75rem; color: var(--text-muted);">
                        {{ p.created_at.strftime('%d.%m.%Y') }}
                    </div>
                </div>
                <div>
                    {% if p.status == 'succeeded' %}
                    <span class="badge badge-success">‚úì</span>
                    {% elif p.status == 'pending' or p.status == 'waiting' %}
                    <span class="badge badge-warning">‚è≥</span>
                    {% else %}
                    <span class="badge badge-danger">‚úó</span>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
        <a href="/admin/payments" style="display: block; text-align: center; margin-top: 1rem; font-size: 0.875rem;">
            –í—Å–µ –ø–ª–∞—Ç–µ–∂–∏ ‚Üí
        </a>
        {% else %}
        <p style="color: var(--text-muted); text-align: center; padding: 2rem 0;">
            –ü–ª–∞—Ç–µ–∂–µ–π –ø–æ–∫–∞ –Ω–µ—Ç
        </p>
        {% endif %}
    </div>
</div>
{% endblock %}
