{% extends "base.html" %}

{% block title %}–°–æ–≥–ª–∞—Å–∏—è –Ω–∞ –æ—Ñ–µ—Ä—Ç—É ‚Äî XK Media{% endblock %}

{% block logo %}
<a href="/admin" class="logo">
    <span class="logo-icon">üì∫</span>
    XK Media
</a>
{% endblock %}

{% block nav %}
<a href="/admin">–î–∞—à–±–æ—Ä–¥</a>
<a href="/admin/users">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</a>
<a href="/admin/tvs">–≠–∫—Ä–∞–Ω—ã</a>
<a href="/admin/payments">–ü–ª–∞—Ç–µ–∂–∏</a>
<a href="/admin/payouts">–í—ã–ø–ª–∞—Ç—ã</a>
<a href="/admin/settings" class="active">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
<a href="/logout" class="btn btn-secondary btn-sm">–í—ã–π—Ç–∏</a>
{% endblock %}

{% block content %}
<div class="dashboard-header">
    <div>
        <a href="/admin/settings" class="back-link">‚Üê –ù–∞–∑–∞–¥ –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º</a>
        <h1>üìã –°–æ–≥–ª–∞—Å–∏—è –Ω–∞ –æ—Ñ–µ—Ä—Ç—É</h1>
        <p class="subtitle">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –ø—Ä–∏–Ω—è–≤—à–∏–µ —É—Å–ª–æ–≤–∏—è –æ—Ñ–µ—Ä—Ç—ã</p>
    </div>
</div>

<!-- Stats -->
<div class="grid grid-3">
    <div class="card stat-card">
        <div class="stat-icon">‚úÖ</div>
        <div class="stat-value">{{ total_accepted }}</div>
        <div class="stat-label">–í—Å–µ–≥–æ –ø—Ä–∏–Ω—è–ª–∏</div>
    </div>
    <div class="card stat-card">
        <div class="stat-icon">üì¢</div>
        <div class="stat-value">{{ advertisers }}</div>
        <div class="stat-label">–†–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª–µ–π</div>
    </div>
    <div class="card stat-card">
        <div class="stat-icon">üì∫</div>
        <div class="stat-value">{{ venues }}</div>
        <div class="stat-label">–í–ª–∞–¥–µ–ª—å—Ü–µ–≤ –ø–ª–æ—â–∞–¥–æ–∫</div>
    </div>
</div>

<!-- Users Table -->
<div class="card">
    <div class="card-header">
        <h3>üìã –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
    </div>
    <div class="card-content">
        {% if users %}
        <table class="table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
                    <th>–†–æ–ª—å</th>
                    <th>–í–µ—Ä—Å–∏—è –æ—Ñ–µ—Ä—Ç—ã</th>
                    <th>–î–∞—Ç–∞ —Å–æ–≥–ª–∞—Å–∏—è</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                {% for u in users %}
                <tr>
                    <td>{{ u.id }}</td>
                    <td>
                        <strong>{{ u.email }}</strong>
                        {% if u.company_name %}
                        <br><span class="text-secondary">{{ u.company_name }}</span>
                        {% endif %}
                    </td>
                    <td>
                        {% if u.role == 'advertiser' %}
                        <span class="badge badge-info">–†–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª—å</span>
                        {% elif u.role == 'venue' %}
                        <span class="badge badge-warning">–ü–ª–æ—â–∞–¥–∫–∞</span>
                        {% else %}
                        <span class="badge">{{ u.role }}</span>
                        {% endif %}
                    </td>
                    <td>{{ u.offer_version or "‚Äî" }}</td>
                    <td>{{ u.offer_accepted_at.strftime("%d.%m.%Y %H:%M") if u.offer_accepted_at else "‚Äî" }}</td>
                    <td>
                        <a href="/admin/user/{{ u.id }}" class="btn btn-sm">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <div class="empty-state">
            <div class="empty-icon">üìã</div>
            <p>–ü–æ–∫–∞ –Ω–∏–∫—Ç–æ –Ω–µ –ø—Ä–∏–Ω—è–ª –æ—Ñ–µ—Ä—Ç—É</p>
        </div>
        {% endif %}
    </div>
</div>

<style>
.back-link {
    display: inline-block;
    color: var(--text-secondary);
    text-decoration: none;
    margin-bottom: 0.5rem;
}

.back-link:hover {
    color: var(--accent);
}
</style>
{% endblock %}
