{% extends "base.html" %}

{% block title %}–ú–æ–∏ —Ä–µ–∫–ª–∞–º—ã ‚Äî XK Media{% endblock %}

{% block logo %}
<a href="/advertiser" class="logo">
    <span class="logo-icon">üì∫</span>
    XK Media
</a>
{% endblock %}

{% block nav %}
<a href="/advertiser">–î–∞—à–±–æ—Ä–¥</a>
<a href="/advertiser/stats">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</a>
<a href="/advertiser/subscriptions">–ü–æ–¥–ø–∏—Å–∫–∏</a>
<a href="/advertiser/payments">–ü–ª–∞—Ç–µ–∂–∏</a>
<a href="/advertiser/profile">–ü—Ä–æ—Ñ–∏–ª—å</a>
<a href="/logout" class="btn btn-secondary btn-sm">–í—ã–π—Ç–∏</a>
{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">üì∫ –ú–æ–∏ —Ä–µ–∫–ª–∞–º–Ω—ã–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è</h1>
    <p class="page-subtitle">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–∫–∞–∑–æ–≤ –∏ –∫–ª–∏–∫–æ–≤ –ø–æ –≤—Å–µ–º –≤–∞—à–∏–º —Ä–µ–∫–ª–∞–º–∞–º</p>
</div>

<!-- –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
<div class="grid grid-3" style="margin-bottom: 2rem;">
    <div class="card stat-card">
        <div class="stat-value" style="color: var(--accent);">{{ stats.total_impressions }}</div>
        <div class="stat-label">–í—Å–µ–≥–æ –ø–æ–∫–∞–∑–æ–≤</div>
    </div>
    <div class="card stat-card">
        <div class="stat-value" style="color: var(--success);">{{ stats.total_clicks }}</div>
        <div class="stat-label">–í—Å–µ–≥–æ –∫–ª–∏–∫–æ–≤</div>
    </div>
    <div class="card stat-card">
        <div class="stat-value">{{ stats.active_count }}</div>
        <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö —Ä–∞–∑–º–µ—â–µ–Ω–∏–π</div>
    </div>
</div>

<!-- –°–ø–∏—Å–æ–∫ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Ä–∞–∑–º–µ—â–µ–Ω–∏–π -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title">üìã –í—Å–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è ({{ campaigns|length }})</h3>
    </div>
    
    {% if campaigns %}
    <table class="table">
        <thead>
            <tr>
                <th>–¢–í / –ú–µ—Å—Ç–æ</th>
                <th>–†–µ–∫–ª–∞–º–∞</th>
                <th>–ü–æ–∫–∞–∑—ã</th>
                <th>–ö–ª–∏–∫–∏</th>
                <th>CTR</th>
                <th>–°—Ç–∞—Ç—É—Å</th>
            </tr>
        </thead>
        <tbody>
            {% for c in campaigns %}
            <tr>
                <td>
                    <div style="font-weight: 600;">{{ c.tv.name }}</div>
                    <div style="font-size: 0.75rem; color: var(--text-muted);">
                        {{ c.tv.venue_name or c.tv.address or '' }}
                    </div>
                    {% if c.tv.city %}
                    <div style="font-size: 0.75rem; color: var(--text-muted);">{{ c.tv.city }}</div>
                    {% endif %}
                </td>
                <td>
                    <div style="font-weight: 500;">{{ c.title }}</div>
                    <a href="{{ c.url }}" target="_blank" style="font-size: 0.75rem;">{{ c.url[:40] }}...</a>
                    {% if c.description %}
                    <div style="font-size: 0.75rem; color: var(--text-muted);">{{ c.description[:50] }}...</div>
                    {% endif %}
                </td>
                <td style="font-size: 1.25rem; font-weight: 600; color: var(--accent);">
                    {{ c.impressions or 0 }}
                </td>
                <td style="font-size: 1.25rem; font-weight: 600; color: var(--success);">
                    {{ c.clicks or 0 }}
                </td>
                <td style="font-weight: 600;">
                    {% if c.impressions and c.impressions > 0 %}
                    {{ "%.2f"|format(c.clicks / c.impressions * 100) }}%
                    {% else %}
                    0%
                    {% endif %}
                </td>
                <td>
                    {% if c.is_active %}
                    <span class="badge badge-success">–ê–∫—Ç–∏–≤–Ω–∞</span>
                    {% else %}
                    <span class="badge badge-danger">–ù–µ–∞–∫—Ç–∏–≤–Ω–∞</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div style="text-align: center; padding: 3rem; color: var(--text-muted);">
        <p style="font-size: 1.25rem; margin-bottom: 1rem;">üì≠ –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Ä–∞–∑–º–µ—â–µ–Ω–∏–π</p>
        <p>–°–≤—è–∂–∏—Ç–µ—Å—å —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –≤–∞—à–µ–π —Ä–µ–∫–ª–∞–º—ã –Ω–∞ –¢–í-—ç–∫—Ä–∞–Ω–∞—Ö</p>
    </div>
    {% endif %}
</div>

<!-- –ü–æ—è—Å–Ω–µ–Ω–∏–µ –∫ –º–µ—Ç—Ä–∏–∫–∞–º -->
<div class="card" style="margin-top: 1.5rem;">
    <div class="card-header">
        <h3 class="card-title">üìä –ü–æ—è—Å–Ω–µ–Ω–∏–µ –∫ –º–µ—Ç—Ä–∏–∫–∞–º</h3>
    </div>
    <div class="grid grid-3">
        <div>
            <div style="font-weight: 600; margin-bottom: 0.5rem;">–ü–æ–∫–∞–∑—ã (Impressions)</div>
            <div style="font-size: 0.875rem; color: var(--text-muted);">
                –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑, –∫–æ–≥–¥–∞ –≤–∞—à–∞ —Ä–µ–∫–ª–∞–º–∞ –±—ã–ª–∞ –ø–æ–∫–∞–∑–∞–Ω–∞ –Ω–∞ —ç–∫—Ä–∞–Ω–µ
            </div>
        </div>
        <div>
            <div style="font-weight: 600; margin-bottom: 0.5rem;">–ö–ª–∏–∫–∏ (Clicks)</div>
            <div style="font-size: 0.875rem; color: var(--text-muted);">
                –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –ø–æ –≤–∞—à–µ–π —Å—Å—ã–ª–∫–µ (—á–µ—Ä–µ–∑ QR-–∫–æ–¥)
            </div>
        </div>
        <div>
            <div style="font-weight: 600; margin-bottom: 0.5rem;">CTR</div>
            <div style="font-size: 0.875rem; color: var(--text-muted);">
                Click-Through Rate ‚Äî –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫–ª–∏–∫–æ–≤ –∫ –ø–æ–∫–∞–∑–∞–º –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
            </div>
        </div>
    </div>
</div>
{% endblock %}
